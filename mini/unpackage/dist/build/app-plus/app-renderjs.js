var __renderjsModules={};
__renderjsModules["4fc65f2c"]=(()=>{var b=Object.defineProperty;var J=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var T=Object.prototype.hasOwnProperty;var k=(r,d)=>{for(var l in d)b(r,l,{get:d[l],enumerable:!0})},A=(r,d,l,m)=>{if(d&&typeof d=="object"||typeof d=="function")for(let a of C(d))!T.call(r,a)&&a!==l&&b(r,a,{get:()=>d[a],enumerable:!(m=J(d,a))||m.enumerable});return r};var B=r=>A(b({},"__esModule",{value:!0}),r);var L={};k(L,{default:()=>D});var D={methods:{generatePoster(r,d,l,m){if(!r||!r.url)return;let a=r.url,s=r.originalPath,e=document.createElement("video");e.crossOrigin="anonymous",e.muted=!0,e.autoplay=!0,e.setAttribute("playsinline","true"),e.setAttribute("webkit-playsinline","true");let p=setTimeout(()=>{l.callMethod("handleVideoProcessed",{url:a,originalPath:s,posterBase64:null})},5e3);e.onloadedmetadata=()=>{if(e.duration&&Number.isFinite(e.duration)&&e.duration>0){let t=Math.min(e.duration,1),c=Math.random()*t;e.currentTime=c}else e.currentTime=.1},e.onseeked=()=>{clearTimeout(p);try{let t=document.createElement("canvas");t.width=e.videoWidth||300,t.height=e.videoHeight||200,t.getContext("2d").drawImage(e,0,0,t.width,t.height);let c=t.toDataURL("image/jpeg",.8);e.onseeked=null,e.pause(),l.callMethod("handleVideoProcessed",{url:a,originalPath:s,posterBase64:c})}catch(t){console.error("RenderJS\u751F\u6210\u5C01\u9762\u9519\u8BEF",t),l.callMethod("handleVideoProcessed",{url:a,originalPath:s,posterBase64:null})}},e.onerror=t=>{clearTimeout(p),console.error("RenderJS\u89C6\u9891\u52A0\u8F7D\u9519\u8BEF",t),l.callMethod("handleVideoProcessed",{url:a,originalPath:s,posterBase64:null})},e.src=a},pickFile(r,d,l,m){if(!r)return;let a=r.type,s=document.getElementById("renderjs-file-input");s&&document.body.removeChild(s);let e=document.createElement("input");e.type="file",e.id="renderjs-file-input",e.style.display="none",e.accept="*/*",document.body.appendChild(e),e.onchange=p=>{let t=p.target.files[0];if(!t){l.callMethod("handleFileSelected",{base64:null});return}if(l.callMethod("handleFileReading",{}),t.size>50*1024*1024){alert("\u6587\u4EF6\u592A\u5927\uFF0C\u8BF7\u9009\u62E9\u5C0F\u4E8E50MB\u7684\u6587\u4EF6"),l.callMethod("handleFileSelected",{base64:null});return}let c=t.name.toLowerCase();if(a==="audio"){if(![".mp3",".wav",".m4a",".aac",".flac",".ogg"].some(o=>c.endsWith(o))){alert("\u8BF7\u9009\u62E9\u97F3\u9891\u6587\u4EF6 (.mp3, .wav, .m4a, etc.)"),l.callMethod("handleFileSelected",{base64:null});return}}else if(![".pdf",".doc",".docx",".txt",".xls",".xlsx",".ppt",".pptx"].some(o=>c.endsWith(o))){alert("\u8BF7\u9009\u62E9\u6587\u6863\u6587\u4EF6 (.pdf, .doc, .docx, .txt, etc.)"),l.callMethod("handleFileSelected",{base64:null});return}let g=!1;try{g=typeof plus!="undefined"&&plus.io}catch(i){console.error("Check plus error",i)}if(g){let i=new FileReader;i.onload=u=>{let o=u.target.result;try{let R=o.split(",")[1],F=window.atob(R),M=F.length,v=new Uint8Array(M);for(let n=0;n<M;n++)v[n]=F.charCodeAt(n);let x=v.buffer;plus.io.resolveLocalFileSystemURL("_doc/",n=>{n.getDirectory("production",{create:!0},y=>{let P=Date.now()+"_"+t.name;y.getFile(P,{create:!0},f=>{f.createWriter(h=>{h.onwrite=()=>{l.callMethod("handleFileSelected",{filePath:f.fullPath,name:t.name,type:a,isSaved:!0})},h.onerror=E=>{console.error("RenderJS Write Error",E),l.callMethod("handleFileSelected",{base64:o,name:t.name,type:a})},h.write(x)},h=>{console.error("RenderJS CreateWriter Error",h),l.callMethod("handleFileSelected",{base64:o,name:t.name,type:a})})},f=>{console.error("RenderJS GetFile Error",f),l.callMethod("handleFileSelected",{base64:o,name:t.name,type:a})})},y=>{console.error("RenderJS GetDirectory Error",y),l.callMethod("handleFileSelected",{base64:o,name:t.name,type:a})})},n=>{console.error("RenderJS ResolveFS Error",n),l.callMethod("handleFileSelected",{base64:o,name:t.name,type:a})})}catch(S){console.error("RenderJS Save Error",S),l.callMethod("handleFileSelected",{base64:o,name:t.name,type:a})}},i.onerror=()=>{l.callMethod("handleFileSelected",{base64:null})},i.readAsDataURL(t)}else{let i=new FileReader;i.onload=u=>{let o=u.target.result;l.callMethod("handleFileSelected",{base64:o,name:t.name,type:a})},i.onerror=()=>{l.callMethod("handleFileSelected",{base64:null})},i.readAsDataURL(t)}},e.click()}}};return B(L);})();
